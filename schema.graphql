# Database for Harper Edge AI Example with MLOps
type Model @table(database: "harper-edge-ai-example") @export {
  # Composite key as single field: "${modelId}:${version}"
  id: ID @primaryKey

  # Model metadata
  modelId: String @indexed
  version: String @indexed
  framework: String @indexed  # "onnx" | "tensorflow" | "tfjs-graph"
  stage: String @indexed      # "development" | "staging" | "production"

  # Model binary data (use Blob for large ONNX/TF models)
  modelBlob: Blob

  # Schema definitions (JSON stringified)
  inputSchema: String
  outputSchema: String
  metadata: String

  # Timestamps
  uploadedAt: Long @createdTime
}

type InferenceEvent @table(database: "harper-edge-ai-example") @export {
  # Primary key - UUID for each inference
  id: ID @primaryKey  # This will be the inferenceId

  # Model information
  modelId: String @indexed
  modelVersion: String @indexed
  framework: String @indexed

  # Request tracking
  requestId: String @indexed
  userId: String @indexed
  sessionId: String @indexed

  # Inference data (JSON stringified)
  featuresIn: String
  prediction: String
  confidence: Float

  # Performance
  latencyMs: Int

  # Feedback loop (nullable until feedback received)
  actualOutcome: String
  feedbackTimestamp: Long
  correct: Boolean

  # Timestamps
  timestamp: Long @createdTime @indexed
}
